<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário Simplificado</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }
        a,p { /* Mantido caso queira usar 'a' ou 'p' com esta fonte em algum lugar */
            font-family: Epilogue !important;
        }

        body {
            background-color: #f3f4f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
            padding: 30px;
            /* margin-left foi removido pois a sidebar foi eliminada */
        }

        h1 {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
        }

        label {
            font-weight: 500;
            margin-bottom: 5px;
            display: block;
            color: #555;
        }

        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
        }

        input[type="text"]:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Proposta Limpeza Simplificada</h1>

        <form id="formulario">

            <label for="nome">Nome<b>*</b>:</label>
            <input type="text" id="nome" name="nome" required/>

            <label for="endereco">Endereço<b>*</b>:</label>
            <input type="text" id="endereco" name="endereco" required/>

            <label for="cidade">Cidade<b>*</b>:</label>
            <input type="text" id="cidade" name="cidade" required/>

            <label for="qtdmodulos">Quantidade de Módulos<b>*</b>:</label>
            <input type="number" id="qtdmodulos" name="qtdmodulos" required/>

            <label for="potmodulos">Potência dos Módulos (Wp por unidade)<b>*</b>:</label>
            <input type="number" id="potmodulos" name="potmodulos" required/>

            <label for="precokwh">Preço do kWh (R$)<b>*</b>:</label>
            <input type="text" id="precokwh" name="precokwh" placeholder="Ex: 0.95" required/>

            <button type="button" onclick="gerarPDF()" id="btnGerarPDF" disabled>Gerar PDF</button>
        </form>
    </div>

    <script>
        function gerarPDF() {
            const formulario = document.getElementById('formulario');
            const formData = new FormData(formulario);

            // Os campos nome, endereco, cidade, qtdmodulos, potmodulos, precokwh
            // já são incluídos automaticamente pelo new FormData(formulario)
            // porque eles têm o atributo 'name'.

            // Opcional: Log para verificar os dados antes de enviar
            // for (var pair of formData.entries()) {
            //     console.log(pair[0]+ ': ' + pair[1]);
            // }

            fetch('https://canalverdedev.com/gerar_pdf_limpeza.php', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('A resposta da rede não foi ok: ' + response.statusText);
                    }
                    return response.blob();
                })
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    
                    const nomeCliente = formData.get('nome') ? formData.get('nome').trim().replace(/\s+/g, '_') : 'Cliente';
                    const nomeArquivo = `Proposta_Limpeza_${nomeCliente}.pdf`;
                    a.download = nomeArquivo;
                    
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                })
                .catch(error => {
                    console.error('Erro ao gerar PDF:', error);
                    alert('Ocorreu um erro ao gerar o PDF: ' + error.message);
                });
        }

        function verificarFormulario() {
            const formulario = document.getElementById('formulario');
            const btnGerarPDF = document.getElementById('btnGerarPDF');
            
            // Verifica se todos os campos requeridos no formulário estão preenchidos
            if (formulario.checkValidity()) {
                btnGerarPDF.disabled = false;
            } else {
                btnGerarPDF.disabled = true;
            }
        }

        // Adiciona ouvintes de evento para verificar o formulário em cada mudança
        document.getElementById('formulario').addEventListener('input', verificarFormulario);
        document.getElementById('formulario').addEventListener('change', verificarFormulario); // Para selects, se houver no futuro

        // Verifica o formulário ao carregar a página
        window.onload = function() {
            verificarFormulario();
        };
    </script>
</body>
</html>