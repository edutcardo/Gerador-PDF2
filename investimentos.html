<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário com Pesquisa</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }
        a,p {
            font-family: Epilogue !important;
        }

        body {
            background-color: #c6f3df;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
            padding: 30px;
            margin-left: 60px; /* Adicione essa linha */
        }

        h1 {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
        }

        label {
            font-weight: 500;
            margin-bottom: 5px;
            display: block;
            color: #555;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
        }

        input[readonly],
        input.hidden {
            background-color: #f0f0f0;
            cursor: not-allowed;
        }

        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }

        #resultados {
            display: none;
        }

        .resultado-item {
            display: none;
        }

        .resultado-item:hover {
            background: #2e7d32;
            color: #fff;
            transform: scale(1.05);
        }

        button {
            background-color: #45a049;
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 8px;
        }

        button:hover {
            background-color: #2e7d32;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
        }
        .hidden {
            display: none;
        }
        .slider {
            width: 100%; /* Deixa o slider ocupar toda a largura disponível */
            height: 20px; /* Aumenta a altura do slider */
            appearance: none; /* Remove o estilo padrão do navegador */
            background: #ddd; /* Define a cor de fundo do slider */
            border-radius: 10px; /* Deixa as bordas arredondadas */
            outline: none; /* Remove a borda ao focar no slider */
            transition: background 0.3s ease; /* Adiciona uma transição suave ao hover */
        }

        .slider:hover {
            background: #ccc; /* Muda o fundo quando o slider é hoverado */
        }

        .slider::-webkit-slider-thumb {
            appearance: none; /* Remove o estilo padrão do botão do slider */
            width: 25px; /* Largura do botão */
            height: 25px; /* Altura do botão */
            background: #45a049; /* Cor do botão */
            border-radius: 50%; /* Deixa o botão redondo */
            cursor: pointer; /* Mostra que o botão é clicável */
            transition: background 0.3s ease; /* Suaviza a mudança de cor */
        }

        .slider::-webkit-slider-thumb:hover {
            background: #2e7d32; /* Cor do botão ao passar o mouse */
        }

        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            background: #45a049;
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .slider::-moz-range-thumb:hover {
            background: #2e7d32;
        }
        .sidebar:hover .logo {
            width: 80px; /* Tamanho maior quando expandido */
            height: 80px;
            padding: 8px;
        }
        .sidebar {
            width: 60px;
            background-color: #006b3c;
            transition: width 0.3s;
            overflow: hidden;
            position: fixed; /* Torna a sidebar fixa */
            z-index: 2; /* Mantém a sidebar acima de outros elementos */
            height: 100vh; /* Altura total da tela */
            top: 0; /* Começa do topo */
            left: 0; /* Fixa na lateral esquerda */
        }

        .sidebar:hover {
            width: 200px;

        }
        .sidebar a {
            display: flex; /* Ativa o layout flexível */
            align-items: center; /* Centraliza verticalmente o conteúdo */
            justify-content: flex-start; /* Centraliza horizontalmente (altere para `center` se necessário) */
            padding: 10px; /* Ajusta o espaçamento interno */
            color: #333;
            text-decoration: none;
            position: relative;
            z-index: 2;
            gap: 10px; /* Espaço entre ícone e texto */
            margin-left: 8px;
            margin-top: 24px;
        }
        .sidebar a:hover {
            background-color: #ddd;
        }
        .sidebar a .text {
            display: none; /* Oculta o texto por padrão */
            margin-left: 10px; /* Adiciona espaçamento entre ícone e texto */
        }
        .sidebar:hover a .text {
            display: inline-block; /* Exibe o texto quando a barra está em hover */ 
            font-weight: bold; /* Negrito */
            color: white; /* Cor branca */
        }
        .sidebar:hover .span {
            text-decoration: none;
            text-align: center;
            margin: 0;
        }
        .sidebar img {
            width: 100%; /* Adapta a largura ao contêiner */
            height: 40px; /* Mantém a proporção da altura */
            transition: transform 0.3s, filter 0.3s; /* Suaviza a transição */
            object-fit: contain; /* Garante que a imagem seja ajustada sem distorção */
        }

        .sidebar:hover img {
            content: url('logohover.png'); /* Substitui a imagem por outra */
            filter: brightness(1.2); /* Torna a imagem um pouco mais brilhante (opcional) */
            transform: scale(1.9); /* Aumenta a imagem de forma proporcional (opcional) */
        }
        .sidebar:hover ~ .topbar {
            margin-left: 200px; /* Alinha com a sidebar expandida */
            width: calc(100% - 200px); /* Ajusta a largura para o novo espaço disponível */
        }
        .sidebar:hover ~ .content {
            margin-left: 200px; /* Ajusta para acompanhar a largura expandida da sidebar */
        }
        .icon{
            color: white;
        }
        .containerlogo{
            width: 100%; /* Define o tamanho inicial da logo */
            height: 130px; /* Ajuste as dimensões conforme necessário */
            display: flex;
            justify-content: center;
            align-items: center;

        }
        .logo {
            width: 40px; /* Define o tamanho inicial da logo */
            height: 40px; /* Ajuste as dimensões conforme necessário */
            margin: 10px 0;
            transition: width 0.3s, height 0.3s;
            padding: 0px;
            padding-top: 8px;
        }
        .sidebar:hover ~ .container {
            margin-left: 200px; /* Adicione esta linha para quando a sidebar estiver expandida */
        }
        .selecionado {
            background-color: #45a049;
            color: #fff;
            transform: scale(1.05);
            border: 2px solid #2e7d32;
        }
        /* Estilizando a seção de Multiplicadores */
        .section {
            text-align: center;
            margin: 20px 0;
        }

        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .subtitle {
            font-size: 14px;
            margin-bottom: 20px;
            color: #666;
        }

        /* Contêiner e Botões */
        .multiplicadores-container {
            display: flex;
            justify-content: center;
            gap: 15px; /* Espaçamento adequado */
        }

        .multiplicador {
            width: 60px; 
            height: 60px; 
            background: #4CAF50; /* Cor inicial verde */
            color: white;
            border-radius: 10px; 
            text-align: center;
            line-height: 60px; /* Centraliza o texto verticalmente */
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .multiplicador:hover {
            background: #1e4c20;
        }

        /* Botão Selecionado */
        .multiplicador.selected {
            background: #ff0505; /* Verde escuro ao selecionar */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); /* Destaque */
        }

        @media (max-width: 600px) {
            /* Responsividade: espaçamento e layout mais compacto */
            .multiplicadores-container {
                gap: 10px;
            }

            .multiplicador {
                width: 50px;
                height: 50px;
                line-height: 50px;
                font-size: 14px;
            }
        }
        .opcoes-adicionais {
            padding: 15px;
            background-color: #f7f7f7;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            gap: 10px; /* Adiciona espaçamento entre os itens */
        }

        .opcoes-adicionais label {
            display: flex;
            align-items: center; /* Alinha o texto ao centro do botão */
            font-weight: bold;
            cursor: pointer; /* Torna clicável */
            gap: 10px; /* Espaço entre o radio e o texto */
        }

        .opcoes-adicionais input[type="radio"] {
            margin: 0; /* Remove margens extras ao redor do input */
        }

        .hidden {
            display: none;
        }
        .imagem-usina {
            margin-top: 20px;
            margin-bottom: 35px;
            width: 500px; /* Define a largura fixa */
            height: 400px; /* Define a altura fixa */
            object-fit: cover; /* Adapta a imagem ao contêiner, cortando quando necessário para manter a proporcionalidade */
            border: 2px solid #ddd;
            border-radius: 10px;
            display: none; /* Inicializa escondida */
        }
        /* Inputs */
        .inputs-container {
            flex: 1; /* Ocupa o restante do espaço do contêiner */
            display: flex;
            flex-direction: column; /* Organiza os elementos verticalmente */
            gap: 3px; /* Espaçamento entre inputs */
            align-items: center;
            margin-top: 30px;
        }
        .inputs-container label {
            font-size: 11px;
            width: 100px;
            
        }

        /* Ajuste para entradas */
        .inputs-container input {
            padding: 10px;
            color: #ffffff;
            border-radius: 5px;
            border: 0.5px solid #ddd;
            background-color: #297702;
            font-size: 11px;
            align-items: center;
        }
        /* Contêiner principal para alinhar imagem e inputs */
        .image-input-container {
            display: flex;
            flex-direction: column; /* Alinhar elementos em uma coluna */
            align-items: center; /* Centralizar horizontalmente todos os elementos filhos */
            justify-content: center; /* Centraliza os elementos verticalmente */
            gap: 10px;
            margin-top: 20px;
            background-color: #f5f5f5; /* Cinza claro */
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #ddd;
            margin-bottom: 10px;

        }
        .image-input-container input,
        .image-input-container label {
            text-align: center; /* Alinha o texto dos inputs e labels */
            width: 80%; /* Ajusta a largura conforme necessário */
            margin-bottom: 10px;
            align-items: center;
            margin-left: 50px;
            

        }
        .image-input-container input{
            padding: 10px;
            color: #ffffff;
            border-radius: 11px;
            border: 0.5px solid #ddd;
            background-color: #297702;
            font-size: 15px;
            align-items: center;

        }

        #map {
            height: 600px; /* Altura do mapa */
        }
        #form-container {
            margin-bottom: 10px;
        }
        @media (max-width: 768px) {
            body {
                flex-direction: column; /* Coloca os elementos do corpo em coluna para garantir alinhamento vertical */
            }
            
            #logointerna {
                margin-left: 0; /* Remove a margem esquerda */
                display: block; /* Garante que seja visível */
                margin-bottom: 10px; /* Caso precise de espaço entre elementos */
            }

            .container {
                margin-left: 60px; /* Ou o valor desejado para compensar a largura da sidebar */
                padding: 20px;
                width: calc(250px) /* Ajustar a largura do contêiner considerando a margem da sidebar */
            }
            
            /* Para telas menores, remove a fixação de tamanho da imagem */
            .imagem-usina {
                width: calc(200px); /* Ajuste a largura do contêiner menos afasto */
                height: auto; 
                max-width: 100%; /* Garante que a imagem não exploda a largura do contêiner */
            }
            .image-input-container input,
            .image-input-container label {
                margin-left: 60px; /* Ou o valor desejado para compensar a largura da sidebar */
                width: 200px; /* Maximiza a largura dos inputs e labels */
                font-size: 14px; /* Ajusta o tamanho da fonte para melhorar a leitura */
                margin-left: 0; /* Remove o espaçamento interno esquerdo */
                text-align: center; /* Alinha texto à esquerda para melhor simetria */
            }
            .image-input-container {
                width: 228px; /* Garante que ocupe toda a largura disponível no contêiner */
                padding: 10px; /* Adiciona padding para espaçamento interno */
                box-sizing: border-box; /* Inclui padding e borda na contagem de largura total */
                display: flex;
                flex-direction: column; /* Coloca os elementos em coluna para melhor ajuste visual */
                align-items: center; /* Centraliza os elementos horizontalmente */
                justify-content: center; /* Centraliza os elementos verticalmente */
                background-color: #f5f5f5; /* Contorno visual separando da LP */
            }

            #input-concessionaria-container {
                margin-left: 60px; /* Ou o valor desejado para compensar a largura da sidebar */
                width: 250px; /* Garante a ocupação máxima da largura */
                margin-bottom: 10px; /* Margem inferior para afastamento entre elementos */
            }
            #logointerna {
                display: none;
            }
            #inputConcessionaria {
                text-align: center; /* Como o justify não completamente aplicável a inputs, manter centrar ou alinha ao lado */
                width: 200px; 
                height: 40px;
            }

        }
        
        .sidebar:hover + .container input#inputConcessionaria {
            width: calc(100% - 20px); /* Leva em conta padding e margem para largura máxima */
        }


        @media (max-width: 480px) {
            .container {
                padding: 10px; /* Reduz o padding do contêiner principal */
            }

            .image-input-container {
                gap: 5px; /* Reduzido para acomodar melhor os elementos */
            }
        }
        #logointerna {
            width: 150px; /* Largura desejada */
            height: auto; /* Mantém a proporção da imagem */
            margin-bottom: 10px; /* Adiciona espaçamento inferior */
            display: block; /* Garante que a imagem fique em uma nova linha */
            margin-left: 150px;
            margin-top: 10px;
        }

        .input-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }


    </style>
</head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />


<body>
    <div class="sidebar" id="sidebar">
        <div class="toggle-btn" onclick="toggleSidebar()"></div>
        <div class="containerlogo"> 
            <img src="logo.png" alt="Logo" class="logo"> 
        </div> 
        <a href="index.html" class="home">
            <i class="fa-solid fa-coins icon"></i> <span class="text">Autoconsumo</span>
        </a>
        <a href="investimentos.html">
            <i class="fa-solid fa-solar-panel icon"></i><span class="text">Investimentos</span>
        </a>
        <a href="cocamar.html">
            <i class="fa-solid fa-gauge icon"></i> <span class="text">Cocamar</span>
        </a>
        <a href="coopgb.html">
            <i class="fa-solid fa-paste icon"></i><span class="text">Coop. Grupo B</span>
        </a>
        <a href="coopga.html">
            <i class="fa-solid fa-paste icon"></i><span class="text">Coop. Grupo A</span>
        </a>
        <a href="limpeza.html">
            <i class="fa-solid fa-spray-can-sparkles icon"></i><span class="text">Limpeza</span>
        </a>

    </div>
    <div class="container">
        <h1>Proposta Investimento</h1>

        <form id="formulario"W>

            <select id="usina" name="usina" required onchange="exibirImagem(); buscarUsinaDados(this.value);">
                <option value="vazio">Escolha uma opção</option>
                <option value="75kwSolo">USINA 75KW SOLO</option>
                <option value="75kwTelhado">USINA 75KW TELHADO</option>
                <option value="300kwSolo">USINA 300KW SOLO</option>
                <option value="300kwTelhado">USINA 300KW TELHADO</option>
                <option value="1mwSolo">USINA 1MW SOLO</option>
                <option value="1mwTelhado">USINA 1MW TELHADO</option>
            </select>

            <script>
            document.getElementById('usina').addEventListener('change', function() {
                const usinaValue = this.value;
                const inputConcessionariaContainer = document.getElementById('input-concessionaria-container');
                
                if (usinaValue === 'vazio') {
                    inputConcessionariaContainer.style.display = 'none';
                } else {
                    inputConcessionariaContainer.style.display = 'block';
                }
            });
            </script>
            
            <label for="cep">CEP<b>*</b>:</label>
            <input type="text" id="cep" name="cep" oninput="buscarCidadePorCEP()" placeholder="87010255"/>

            <label for="cidade">Cidade<b>*</b>:</label>
            <input type="text" id="cidade" name="cidade" oninput="buscarConcessionariaPorCidade()" placeholder="Maringá"/>

            <div class="image-input-container">
                <div id="input-concessionaria-container" class="hidden">

                    <img id="imagem-usina" class="imagem-usina hidden" alt="Imagem da usina">
                    <label for="inputConcessionaria" placeholder="COPEL">Concessionária<b>*</b> (Altere manualmente caso não seja a concessionária desejada.):</label>
                    <input type="text" id="inputConcessionaria"/>
      
                    <label for="precoFinalBack">Preço Final:</label>
                    <input type="text" id="precoFinalBack" name="precoFinalBack" readonly />

                    <label for="retornoVerde">Retorno em bandeira verde:</label>
                    <input type="text" id="retornoVerde" name="retornoVerde" readonly />

                    <label for="rentabilidadeVerde">Rentabilidade Verde:</label>
                    <input type="text" id="rentabilidadeVerde" name="rentabilidadeVerde" readonly />

                    <label for="retornoVerdeAnual">Retorno Verde Anual:</label>
                    <input type="text" id="retornoVerdeAnual" name="retornoVerdeAnual" readonly />

                </div>
                
            </div>

            <label for="nome">Nome na proposta comercial<b>*</b>:</label>
            <input type="text" id="nome" name="nome" placeholder="Usina Investimento"/>

            <label for="endereco">Endereço na proposta comercial<b>*</b>:</label>
            <input type="text" id="endereco" name="endereco" placeholder="A definir"/>

            <label for="inputValorCompensavel" class="hidden">Valor Compensável<b>*</b>:</label>
            <input type="text" id="inputValorCompensavel" readonly  class="hidden"/>

            <label for="irradiacao" class="readonly">Irradiação:</label>
            <input type="text" id="irradiacao" name="irradiacao" readonly  class="readonly"required/>

            <label for="uc" class="hidden">Unidade Consumidora<b>*</b>:</label>
            <input type="text" id="uc" name="uc" required class="hidden"/>

            <label for="media" class="hidden">Média<b>*</b>:</label>
            <input type="text" id="media" name="media" class="hidden"/>

            <label for="numeroDeFases" class="hidden">Número de fases<b>*</b>:</label>
            <select id="numeroDeFases" name="numeroDeFases" required class="hidden">
                <option value="monofasico">MONOFÁSICO</option>
                <option value="bifasico">BIFÁSICO</option>
                <option value="trifasico">TRIFÁSICO</option>
                <option value="monoRural">MONO RURAL</option>
            </select>

            <label for="iluminacao" class="hidden">Iluminação<b>*</b>:</label>
            <input type="text" id="iluminacao" name="iluminacao" class="hidden"/>

            <label for="valoramais"  class="hidden">Acrescentar valor:</label>
            <input type="text" id="valoramais" name="valoramais" class="hidden"/>

            <label for="desconto" class="hidden">Desconto:</label>
            <select id="desconto" name="desconto" class="hidden">
                <option value="">Selecione um desconto</option>
                <option value="1%">1%</option>
                <option value="2%">2%</option>
                <option value="3%">3%</option>
            </select>

            <label for="padrao" class="hidden">Padrão entrada:</label>
            <select id="padrao" name="padrao" class="hidden">
                <option value="">Selecione um padrão</option>
                <option value="2x50A">2x50A</option>
                <option value="3x50A">3x50A</option>
                <option value="3x63A">3x63A</option>
                <option value="3x80A">3x80A</option>
                <option value="3x100A">3x100A</option>
                <option value="3x125A">3x125A</option>
                <option value="3x150A">3x150A</option>
                <option value="3x175A">3x175A</option>
                <option value="3x200A">3x200A</option>
                <option value="TORRE 112,5 KVA">TORRE 112,5 KVA</option>
                <option value="TORRE 150 KVA">TORRE 150 KVA</option>
                <option value="TORRE 225 KVA">TORRE 225 KVA</option>
                <option value="TORRE 300 KVA">TORRE 300 KVA</option>
                <option value="TORRE 1 MVA">TORRE 1 MVA</option>
            </select>

            <label for="estrutura" class="hidden">Selecione uma Estrutura<b>*</b>:</label>
            <select id="estrutura" name="estrutura" onchange="buscarResultados(); verificarEstrutura();" required class="hidden">
                <option value="">Selecione uma estrutura</option>
                <option value="COLONIAL">COLONIAL</option>
                <option value="FIBROMADEIRA">FIBROMADEIRA</option>
                <option value="FIBROMETAL">FIBROMETAL</option>
                <option value="METALICO">METALICO</option>
                <option value="S/ESTRUTURA">S/ESTRUTURA</option>
                <option value="SOLO">SOLO</option>
            </select>

            <label for="potSlider" class="hidden">Potência do Gerador<b>*</b>:</label>
            <input type="range" id="potSlider" name="potSlider" min="0" max="116" value="0" step="1" class="slider hidden" oninput="atualizarSlider(this.value); buscarResultados(); calcularResultado()" required/>
            <span id="slider-value" class="hidden">0</span>

            <input type="text" id="resultado" name="resultado" readonly required class="hidden"/>

            <div id="resultados" class="hidden" required></div>

            <div id="multiplicadores-section" class="section hidden">
                <h3 class="title">Multiplique seu kit</h3>
                <p class="subtitle">(para usinas maiores)</p>
                <div id="multiplicadores" class="multiplicadores-container">
                    <div class="multiplicador" data-value="2">X2</div>
                    <div class="multiplicador" data-value="3">X3</div>
                    <div class="multiplicador" data-value="4">X4</div>
                </div>
                <!-- Campo oculto para envio PHP -->
                <input type="hidden" id="multiplicador" name="multiplicador" value="" class="hidden">
            </div>

            <label for="preco" class="readonly">Preço do Integrador:</label>
            <input type="text" id="preco" name="preco" readonly  class="readonly"/>

            <div id="quantidadePlacasDiv" class="hidden">
                <label for="quantidadePlacas" class="hidden">Quantidade de Placas:</label>
                <input type="number" id="quantidadePlacasInput" name="quantidadePlacas" min="1"  class="hidden"/>
            </div>

            <label for="adicionais" class="adicionais-label hidden" class="hidden">Opções Adicionais:</label>
            <div id="adicionais" class="opcoes-adicionais hidden" class="hidden">
                <label for="alambrado">
                    <input type="radio" id="alambrado" name="opcao_adicional" value="Adicionar alambrado">
                    Adicionar alambrado
                </label>

                <label for="britas">
                    <input type="radio" id="britas" name="opcao_adicional" value="Adicionar britas">
                    Adicionar britas
                </label>
                
                <label for="alambrado_britas">
                    <input type="radio" id="alambrado_britas" name="opcao_adicional" value="Adicionar alambrado + britas">
                    Adicionar alambrado + britas
                </label>
            </div>

            <!-- Adicionar os campos de entrada para as novas informações -->
            <label for="codProd" class="readonly">Código do Produto:</label>
            <input type="text" id="codProd" name="codProd" readonly  class="readonly"/>

            <label for="marca" class="readonly">Marca:</label>
            <input type="text" id="marca" name="marca" readonly  class="readonly"/>

            <label for="fabricante" class="readonly">Fabricante:</label>
            <input type="text" id="fabricante" name="fabricante" readonly  class="readonly"/>

            <label for="potenciaInversor" class="readonly">Potência do Inversor:</label>
            <input type="text" id="potenciaInversor" name="potenciaInversor" readonly  class="readonly"/>

            <label for="potenciaModulo" class="readonly">Potência do Módulo:</label>
            <input type="text" id="potenciaModulo" name="potenciaModulo" readonly  class="readonly"/>

            <label for="tensaoSaida" class="readonly">Tensão de Saída:</label>
            <input type="text" id="tensaoSaida" name="tensaoSaida" readonly  class="readonly"/>

            <label for="componentes" class="readonly">Componentes:</label>
            <input type="text" id="componentes" name="componentes" readonly  class="readonly"/>

            <label for="potenciaGerador" class="readonly">Potência do Gerador:</label>
            <input type="text" id="potenciaGerador" name="potenciaGerador" readonly  class="readonly"/>

            
            <button onclick="mostrarDetalhes()" readonly  class="readonly">Verificar Telhado</button>
            <div id="detalhes" style="display: none;">
                <input type="text" id="enderecoInput" placeholder="Endereço" />
                <input type="text" id="cidadeInput" placeholder="Cidade" />
                <button onclick="buscarEndereco()">Buscar</button>
                <div id="map"></div>
            </div>

            <button type="button" onclick="gerarPDF()" id="btnGerarPDF">Gerar PDF</button>            <button type="button" onclick="window.location.href='contratousinas.html'" style="background-color: red; color: white; border: none; padding: 12px; width: 100%; border-radius: 6px; font-size: 16px; cursor: pointer; transition: background-color 0.3s ease;">
                Gerar Contrato
            </button>
        </form>
    </div>
    <script>


    function verificarEstrutura() {
        const estrutura = document.getElementById('estrutura').value;
        
        const elementosParaOcultar = [
            document.querySelector('label[for="potSlider"]'),
            document.getElementById('potSlider'),
            document.getElementById('slider-value'),
            document.getElementById('resultado')
        ];

        const quantidadePlacasDiv = document.getElementById('quantidadePlacasDiv');
        const adicionaisDiv = document.querySelector('.opcoes-adicionais');
        const adicionaisLabel = document.querySelector('.adicionais-label');


        if (estrutura === 'SOLO') {
            elementosParaOcultar.forEach(element => element.classList.add('hidden'));


        } else {
            quantidadePlacasDiv.classList.add('hidden');
            adicionaisDiv.classList.add('hidden');
            adicionaisLabel.classList.add('hidden');
            resultados.classList.add('hidden');
            multiplicadores.classList.add('hidden');
        }
    }
        
        function buscarResultados() {
            const estrutura = document.getElementById('estrutura').value;
            const resultadosDiv = document.getElementById('resultados');
            resultadosDiv.innerHTML = ''; 

            let url;
            if (estrutura === 'SOLO') {
                // A consulta apenas por inversores, sem o filtro de potência
                url = `buscar_preco_inv.php?estrutura=SOLO`;
            } else {
                // Consulta com filtro de potenciaGerador para outras estruturas
                const potenciaSlider = document.getElementById('potSlider').value;
                url = `buscar_preco_inv.php?potencia=${encodeURIComponent(potenciaSlider)}&estrutura=${encodeURIComponent(estrutura)}`;
            }

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        data.resultados.slice(0, 90).forEach(item => {
                            const div = document.createElement('div');
                            div.className = 'resultado-item';
                            div.textContent = item.titulo;
                            div.onclick = () => selecionarItem(item);
                            resultadosDiv.appendChild(div);
                        });
                    } else {
                        resultadosDiv.innerHTML = 'Nenhum resultado encontrado';
                    }
                })
                .catch(error => console.error('Erro ao buscar resultados:', error));
        }

        function atualizarSlider(valor) {
            document.getElementById('slider-value').textContent = valor;
        }

        function selecionarItem(item) {
            // Manipula a seleção do item - esse trecho não é ajustado, acordo original
        }



        function selecionarItem(item) {
            // Remover a classe 'selecionado' de todos os itens
            const itens = document.querySelectorAll('.resultado-item');
            itens.forEach(it => it.classList.remove('selecionado'));

            // Adicionar a classe 'selecionado' ao item clicado
            const itemSelecionado = event.currentTarget;
            itemSelecionado.classList.add('selecionado');

            // Preencher o campo de preço e os novos campos com as informações do item
            document.getElementById('preco').value = item.precoDoIntegrador;
            document.getElementById('codProd').value = item.codProd;
            document.getElementById('marca').value = item.marca;
            document.getElementById('fabricante').value = item.fabricante;
            document.getElementById('potenciaInversor').value = item.potenciaInversor;
            document.getElementById('potenciaModulo').value = item.potenciaModulo;
            document.getElementById('tensaoSaida').value = item.tensaoSaida;
            document.getElementById('componentes').value = item.componentes;
            document.getElementById('potenciaGerador').value = item.potenciaGerador;
        }

        function gerarPDF() {
            const formIsValid = mensagemCampoVazio();
            if(!formIsValid){
                alert("ALGUM DOS CAMPOS ESTÁ VAZIO");
                return;
            }

            const formData = new FormData(document.getElementById('formulario'));
                // Adiciona a constante potenciaGerador ao FormData
            const opcaoAdicional = document.querySelector('input[name="opcao_adicional"]:checked');
                if (opcaoAdicional) {
                    formData.append('opcao_adicional', opcaoAdicional.value);
                }
                
            const potenciaGerador = document.getElementById('potenciaGerador').value; // ou use a variável diretamente se já existir
            const potenciaModulo = document.getElementById('potenciaModulo').value;
            const precoKit = document.getElementById('preco').value;
            const numeroDeFases = document.getElementById('numeroDeFases').value;
            const irradiacao = document.getElementById('irradiacao').value;
            const marca = document.getElementById('marca').value;
            const fabricante = document.getElementById('fabricante').value;
            const potenciaInversor = document.getElementById('potenciaInversor').value;
            const padrao = document.getElementById('padrao').value;
            const desconto = document.getElementById('desconto').value;
            const valoramais = document.getElementById('valoramais').value;
            const inputConcessionaria = document.getElementById('inputConcessionaria').value;
            const inputValorCompensavel = document.getElementById('inputValorCompensavel').value;
            const quantidadePlacas = document.getElementById('quantidadePlacasInput').value;
            const estrutura = document.getElementById('estrutura').value;
            const usina = document.getElementById('usina').value;
            const tensaoSaida = document.getElementById('tensaoSaida').value;
            formData.append('tensaoSaida', tensaoSaida);
            formData.append('usina', usina);
            formData.append('estrutura', estrutura);
            formData.append('quantidadePlacas', quantidadePlacas);
            formData.append('padrao', padrao);
            formData.append('desconto', desconto);
            formData.append('valoramais', valoramais);
            formData.append('marca', marca);
            formData.append('fabricante', fabricante);
            formData.append('potenciaInversor', potenciaInversor);
            formData.append('numeroDeFases', numeroDeFases);
            formData.append('irradiacao', irradiacao);
            formData.append('potenciaGerador', potenciaGerador);
            formData.append('potenciaModulo', potenciaModulo);
            formData.append('precoKit', precoKit);
            formData.append('inputConcessionaria', inputConcessionaria);
            formData.append('inputValorCompensavel', inputValorCompensavel);

            
            fetch('gerar_pdf_inv.php', {
                method: 'POST',
                body: formData
            })
                .then(response => response.blob())
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = 'arquivo_gerado.pdf';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                })
                .catch(error => console.error('Erro ao gerar PDF:', error));
        }

        function preencherFormulario() {

        }

        window.onload = preencherFormulario;

        function buscarCidadePorCEP() {
            let cep = document.getElementById('cep').value;

            // Remove qualquer caractere que não seja número (como hífen), o que facilita a validação
            cep = cep.replace(/\D/g, '');

            // Agora podemos validar e fazer a requisição com o formato correto
            if (cep.length === 8) { // Valida se o CEP possui 8 dígitos agora corretamente
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.erro) {
                            document.getElementById('cidade').value = data.localidade;
                            
                            // Chamada direta a buscarConcessionariaPorCidade ao preencher a cidade
                            buscarConcessionariaPorCidade();
                            buscarDados(); 
                            buscarValorCompensavel(); 
                        } else {
                            alert('CEP não encontrado!');
                            document.getElementById('cidade').value = '';
                        }
                    })
                    .catch(error => console.error('Erro ao buscar cidade pelo CEP:', error));
            } else {

            }
        }


        function buscarIrradiacao() {
            const cidade = document.getElementById('cidade').value.trim();
            
            if (cidade !== "") {
                fetch(`buscar_irradiacao.php?cidade=${encodeURIComponent(cidade)}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.success) {
                            document.getElementById('irradiacao').value = data.irradiacao;
                        } else {
                            document.getElementById('irradiacao').value = ''; // Limpa o campo se não encontrado
                            console.warn(data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao buscar irradiação:', error);
                        document.getElementById('irradiacao').value = '';
                    });
            } else {
                document.getElementById('irradiacao').value = ''; // Limpa o campo se não houver input
            }
        }
        // Adiciona a classe 'hidden' a todos os inputs com a classe 'readonly'
            document.querySelectorAll('.readonly').forEach(input => {
            input.classList.add('hidden');
        });
        function calcularResultado() {
            const potencia = parseFloat(document.getElementById('potSlider').value); // Pega o valor digitado
            if (!isNaN(potencia)) {
                const resultado = potencia * 3.9 * 30; // Faz o cálculo
                document.getElementById('resultado').value = `A geração selecionada é: ${resultado.toFixed(0)} kWh - Selecione um kit abaixo`; // Exibe o resultado com 2 casas decimais
            } else {
                document.getElementById('resultado').value = ''; // Limpa o campo se o input for inválido
            }
        }
        function atualizarSlider(valor) {
            document.getElementById('slider-value').textContent = valor; // Exibe o valor do slider ao lado do controle
        }

        function verificarFormulario() {
            const cep = document.getElementById('cep').value.trim();
            const cidade = document.getElementById('cidade').value.trim();
            const nome = document.getElementById('nome').value.trim();
            const endereco = document.getElementById('endereco').value.trim();
            
            const btnGerarPDF = document.getElementById('btnGerarPDF');
            
            // Verifica se os campos requeridos estão preenchidos
            if (cep && cidade && nome && endereco) {
                btnGerarPDF.disabled = false; // Habilita o botão

            } else {

            }
        }

        function mensagemCampoVazio() {
            const cep = document.getElementById('cep').value.trim();
            const cidade = document.getElementById('cidade').value.trim();
            const nome = document.getElementById('nome').value.trim();
            const endereco = document.getElementById('endereco').value.trim();
            
            const btnGerarPDF = document.getElementById('btnGerarPDF');
            
            // Verifica se os campos requeridos estão preenchidos
            if (cep && cidade && nome && endereco) {
                // btnGerarPDF.disabled = false; // Habilita o botão
                return true;
            } else {
                // btnGerarPDF.disabled = true; // Desabilita o botão para garantir que não possa ser clicado
                return false;
            }
        }


        // Chamar a função de verificação sempre que o formulário mudar
        document.getElementById('formulario').addEventListener('input', verificarFormulario);

// Certifica-se de chamar a verificação ao carregar a página
window.onload = verificarFormulario;

        window.onload = function() {
    // Define "Copel" como valor inicial do inputConcessionaria
            document.getElementById('inputConcessionaria').value = 'COPEL';
            document.getElementById('uc').value = '5555';
            document.getElementById('cep').value = '87010-255';
            document.getElementById('inputValorCompensavel').value = '0.4054079';
            document.getElementById('cidade').value = 'Maringá';

            document.getElementById('retornoVerde').value = ''; // Adicionada linha para resultado

            const usinaSelect = document.getElementById('usina');
            const inputConcessionariaContainer = document.getElementById('input-concessionaria-container');
            
            usinaSelect.addEventListener('change', function() {
                if (this.value === 'vazio') {
                    inputConcessionariaContainer.style.display = 'none';
                } else {
                    inputConcessionariaContainer.style.display = 'block';
                }
            });
            
            // Inicialize a visibilidade do contêiner com base no valor inicial
            if (usinaSelect.value === 'vazio') {
                inputConcessionariaContainer.style.display = 'none';
            } else {
                inputConcessionariaContainer.style.display = 'block';
            }



            // Outras funções que precisam ser chamadas quando a página carrega
            preencherFormulario();
        };

        async function buscarUsinaDados(inputConcessionariaValue, usinaValue) {
            try {
                const url = `inputAutomatico.php?inputConcessionaria=${encodeURIComponent(inputConcessionariaValue)}&usina=${encodeURIComponent(usinaValue)}`;
                const response = await fetch(url);

                if (response.ok) {
                    const data = await response.text();

                    if (data.trim() === '') {
                        console.warn('O servidor não retornou um valor');
                    } else {
                        const [retornoVerde, retornoVerdeAnual, precoFinalBack, rentabilidadeVerde] = data.trim().split("|");

                        document.getElementById('retornoVerde').value = retornoVerde;
                        document.getElementById('retornoVerdeAnual').value = retornoVerdeAnual;
                        document.getElementById('precoFinalBack').value = precoFinalBack;
                        document.getElementById('rentabilidadeVerde').value = rentabilidadeVerde;
                    }
                } else {
                    console.error('Resposta não foi ok:', response.statusText);
                }
            } catch (error) {
                console.error('Erro ao buscar dados:', error.message);
            }
        }

        document.getElementById('usina').addEventListener('change', function() {
            const inputConcessionariaValue = document.getElementById('inputConcessionaria').value; // Defina a variável aqui
            const usinaValue = this.value;
            
            if (usinaValue && usinaValue !== 'vazio') {
                buscarUsinaDados(inputConcessionariaValue, usinaValue);
                buscarDados(usinaValue);
            } else {
                // Limpar corretivamente os campos caso não se tenha uma seleção válida
                document.getElementById('retornoVerde').value = '';
                document.getElementById('retorno_verde_12').value = ''; // Limpeza do novo campo
            }
        });
        document.getElementById('cidade').addEventListener('input', buscarDados);

        function buscarValorCompensavel() {
            const concessionaria = document.getElementById('inputConcessionaria').value.trim(); // Use .value para obter o valor

            console.log("Concessionária:", concessionaria); // Log para depuração

            if (concessionaria !== "") {
                fetch(`buscar_compensavel.php?sigla=${encodeURIComponent(concessionaria)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            document.getElementById('inputValorCompensavel').value = data.compensavel;
                        } else {
                            document.getElementById('inputValorCompensavel').value = 'Erro: ' + data.message;
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao buscar valor compensável:', error);
                        document.getElementById('inputValorCompensavel').value = 'Erro de rede';
                    });
            } else {
                document.getElementById('inputValorCompensavel').value = 'Informe uma concessionária';
            }
        }

        document.getElementById('inputConcessionaria').addEventListener('input', buscarValorCompensavel);

        function atualizarDados() {
            buscarIrradiacao();
            buscarDados();
            buscarValorCompensavel();
        }
        function travarDesconto() {
            const valoramaisInput = document.getElementById('valoramais');
            const descontoSelect = document.getElementById('desconto');

            valoramaisInput.addEventListener('input', function() {
                if (valoramaisInput.value.trim() !== "") {
                    descontoSelect.disabled = true;
                } else {
                    descontoSelect.disabled = false;
                }
            });
        }

        document.querySelectorAll('.multiplicador').forEach(element => {
            // Adiciona evento de clique a todos os botões
            element.addEventListener('click', function () {
                // Remove a seleção de outros botões
                document.querySelectorAll('.multiplicador').forEach(el => {
                    el.classList.remove('selected');
                });

                // Adicionar a classe 'selected' ao botão clicado
                this.classList.add('selected');

                // Atualizar o valor no campo oculto
                const multiplicador = this.getAttribute('data-value');
                document.getElementById('multiplicador').value = multiplicador;
            });
        });
        document.getElementById('estrutura').addEventListener('change', function() {
            buscarResultados();
            verificarEstrutura();
        });

        function exibirImagem() {
            const select = document.getElementById('usina');
            const imagem = document.getElementById('imagem-usina');
            const inputConcessionariaContainer = document.getElementById('input-concessionaria-container');
            const selecao = select.value;

            const configs = {
                '75kwSolo': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '75kwsolo.png',
                    padrao: '3x200A',
                    estrutura: 'SOLO',
                    quantidadePlacas: 160,
                    multiplicador: 1
                },
                '75kwTelhado': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '75kwtelhado.png',
                    padrao: '3x200A',
                    estrutura: 'FIBROMETAL',
                    quantidadePlacas: 0,
                    multiplicador: 1
                },
                '300kwSolo': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '300kwsolo.png',
                    padrao: 'TORRE 300 KVA',
                    estrutura: 'SOLO',
                    quantidadePlacas: 160,
                    multiplicador: 4
                },
                '300kwTelhado': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '300kwtelhado.png',
                    padrao: 'TORRE 300 KVA',
                    estrutura: 'FIBROMETAL',
                    quantidadePlacas: 0,
                    multiplicador: 4
                },
                '1mwSolo': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '1mwsolo.png',
                    padrao: 'TORRE 1 MVA',
                    estrutura: 'SOLO',
                    quantidadePlacas: 214,
                    multiplicador: 10
                },
                '1mwTelhado': {
                    media: '1',
                    iluminacao: '100',
                    imagem: '1mwtelhado.png',
                    padrao: 'TORRE 1 MVA',
                    estrutura: 'FIBROMETAL',
                    quantidadePlacas: 0,
                    multiplicador: 13
                }
            };

            const config = configs[selecao];

            if (config) {
                imagem.src = config.imagem;
                imagem.style.display = 'block';
                console.log(`Caminho da imagem: ${config.imagem}`);
                document.getElementById('padrao').value = config.padrao || '';
                document.getElementById('estrutura').value = config.estrutura || '';
                document.getElementById('media').value = config.media || '1';
                document.getElementById('iluminacao').value = config.iluminacao || '';
                inputConcessionariaContainer.classList.remove('hidden');
                
                verificarEstrutura(); // Altera visibilidade de elementos dependendo de `estrutura`
                
                // Preenchimento adicional
                if (config.quantidadePlacas) {
                    document.getElementById('quantidadePlacasInput').value = config.quantidadePlacas;
                }

                if (config.multiplicador) {
                    document.getElementById('multiplicador').value = config.multiplicador;
                }

                // Atualizar resultados depois de ajustar todos os parâmetros
                buscarResultados();

            } else {
                imagem.style.display = 'none';
                console.warn('Nenhuma configuração disponível para esta seleção.');
                
                // Zerar campos ao deselecionar usinas
                document.getElementById('padrao').value = '';
                document.getElementById('estrutura').value = '';
                document.getElementById('media').value = '';
                document.getElementById('iluminacao').value = '';

            }
        }
        function buscarResultados() {
            const estrutura = document.getElementById('estrutura').value;
            const resultadosDiv = document.getElementById('resultados');
            resultadosDiv.innerHTML = '';

            // Define o valor do potSlider para 112 antes de usar
            const potenciaSlider = document.getElementById('potSlider');
            potenciaSlider.value = 112;
            atualizarSlider(112); // Atualiza a exibição do valor do slider

            let url = `buscar_preco_inv.php?potencia=${encodeURIComponent(potenciaSlider.value)}&estrutura=${encodeURIComponent(estrutura)}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.resultados.length > 0) {
                        data.resultados.slice(0, 90).forEach((item, index) => {
                            const div = document.createElement('div');
                            div.className = 'resultado-item';
                            div.textContent = item.titulo;
                            div.onclick = () => selecionarItem(item, div);
                            resultadosDiv.appendChild(div);
                            
                            // Selecionar o primeiro item automaticamente para qualquer estrutura
                            if (index === 0) {
                                selecionarItem(item, div);
                            }
                        });
                    } else {
                        resultadosDiv.innerHTML = 'Nenhum resultado encontrado';
                    }
                })
                .catch(error => console.error('Erro ao buscar resultados:', error));
        }
        function selecionarItem(item, element) {
            // Limpar seleção de outros itens
            const itens = document.querySelectorAll('.resultado-item');
            itens.forEach(it => it.classList.remove('selecionado'));

            // Marcar o item atual como selecionado
            if (element) {
                element.classList.add('selecionado');
            }

            // Preencher os campos com informações do item selecionado
            if (item) {
                console.log('Item selecionado:', item.titulo);
                document.getElementById('preco').value = item.precoDoIntegrador;
                document.getElementById('codProd').value = item.codProd;
                document.getElementById('marca').value = item.marca;
                document.getElementById('fabricante').value = item.fabricante;
                document.getElementById('potenciaInversor').value = item.potenciaInversor;
                document.getElementById('potenciaModulo').value = item.potenciaModulo;
                document.getElementById('tensaoSaida').value = item.tensaoSaida;
                document.getElementById('componentes').value = item.componentes;
                document.getElementById('potenciaGerador').value = item.potenciaGerador;
            }
        }
            async function buscarDados(usinaValue) {
                try {
                    const response = await fetch(`consultar_usina.php?usina=${encodeURIComponent(usinaValue)}`);
                    if (!response.ok) throw new Error('Erro na resposta da rede');

                    const data = await response.json();
                    console.log('Dados recebidos:', data);

                    if (data.success) {
                        // Função para formatar o valor monetário
                        const formatarMoeda = valor => {
                            // Converte para string, substitui vírgula por ponto, fixa duas casas decimais
                            const valorNumerico = parseFloat(valor).toFixed(2) || '0.00';
                            // Sintaxe RegExp \d(?=(\d{3})+\.), insere pontos como separadores de milhar
                            return valorNumerico.replace('.', ',').replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                        };

                        // Função para formatar porcentagem
                        const formatarPercentual = valor => {
                            // Divide por 100, fixa duas casas decimais, transforma o número e acrescenta o símbolo de %
                            return `${parseFloat(valor).toFixed(2).replace('.', ',')}%`;
                        };


                    } else {
                        throw new Error(data.message || 'Erro ao buscar dados');
                    }
                } catch (error) {
                    console.error('Erro ao buscar dados:', error);
                }
            }

            document.getElementById('usina').addEventListener('change', function() {
                const usinaValue = this.value;
                if (usinaValue && usinaValue !== 'vazio') {
                    buscarDados(usinaValue);
                } else {
                    // Limpar campos se "Escolha uma opção" for selecionado
                    document.getElementById('preco_final').value = '';
                    document.getElementById('retorno_verde').value = '';
                    document.getElementById('media_liquido').value = '';
                    document.getElementById('rentabilidade_verde').value = '';
                    document.getElementById('retorno_verde_12').value = '';
                }
            });


            function buscarEndereco() {
                var endereco = document.getElementById("enderecoInput").value;
                var cidade = document.getElementById("cidadeInput").value;
                var query = encodeURIComponent(`${endereco}, ${cidade}`);
                
                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.length > 0) {
                            var coordenadas = [data[0].lat, data[0].lon];
                            map.setView(coordenadas, 15);
                            
                            if (marcador) {
                                marcador.setLatLng(coordenadas);
                            } else {
                                marcador = L.marker(coordenadas).addTo(map);
                            }

                            marcador.bindPopup(`<b>Resultado</b><br>${endereco}, ${cidade}`).openPopup();
                        } else {
                            alert("Endereço não encontrado!");
                        }
                    })
                    .catch(error => console.error('Erro:', error));
            }


            function buscarConcessionariaPorCidade() {
                const cidade = document.getElementById('cidade').value.trim();
                
                if (cidade !== "") {
                    fetch(`buscar_dados.php?cidade=${encodeURIComponent(cidade)}`)
                        .then(response => response.json())
                        .then(data => {
                            console.log(data); // Log de depuração
                            if (data.success) {
                                const inputConcessionaria = document.getElementById('inputConcessionaria');
                                inputConcessionaria.value = data.concessionaria;
                                buscarValorCompensavel(); // Chame a função após definir o valor

                            } else {
                                document.getElementById('inputConcessionaria').value = 'Erro: ' + data.message;
                            }
                        })
                        .catch(error => {
                            console.error('Erro ao buscar dados:', error);
                            document.getElementById('inputConcessionaria').value = 'Erro de rede';
                        });
                } else {
                    document.getElementById('inputConcessionaria').value = 'Informe uma cidade';
                }

                // Adicione esta linha para redefinir o select usina
                const selectUsina = document.getElementById('usina');
                selectUsina.value = 'vazio';
                
                // Atualiza a visibilidade do input-concessionaria-container
                const inputConcessionariaContainer = document.getElementById('input-concessionaria-container');
                inputConcessionariaContainer.style.display = 'none';
            }
    </script>
</body>
</html>